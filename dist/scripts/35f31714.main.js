!function(a,b){window.pkcensus=window.pkcensus||b}(this,function(){"use strict";"undefined"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(a){for(var b=this,c=0;c<b.length;c++)if(b[c]===a)return c;return-1});var a={};return a.gmap={iw:$(".app-container"),markers:[],init:function(a,b,c,d,e){this.canvas=a,this.defaultPosition=new google.maps.LatLng(parseFloat(b),parseFloat(c)),this.zoom="undefined"!=typeof d?parseInt(d):8,this.mapDefaults={center:this.defaultPosition,zoom:this.zoom,disableDefaultUI:!0,styles:[{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{weight:1}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]}]};var f=this.map=new google.maps.Map(this.canvas,this.mapDefaults);google.maps.event.addListenerOnce(this.map,"tilesloaded",function(){return e&&"function"==typeof e?e.call(this,f):!1})},setMarkers:function(){var a=this;$.getJSON("/bower_components/pk-census/data/census-data.json",function(b,c){if(c&&"success"===c)for(var d=b.length-1;d>=0;d--){var e=b[d],f=new MarkerWithLabel({position:new google.maps.LatLng(e.location.lat,e.location.lng),map:a.map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:3,strokeOpacity:.85,strokeColor:"#c30"},labelClass:"district-marker",labelContent:e.title,labelVisible:!1,labelAnchor:new google.maps.Point(-3,34)});a.markers.push(f),a.setMarkerInfo(a,f,e)}})},setMarkerInfo:function(a,b,c){var d=a;google.maps.event.addListener(b,"mouseover",function(){this.set("labelVisible",!0)}),google.maps.event.addListener(b,"mouseout",function(){this.set("labelVisible",!1)}),google.maps.event.addListener(b,"click",function(){return d.loadMarkerInfo(d,this,c)})},loadMarkerInfo:function(a,b,c){var d=a;d.iw.hasClass("col-sm-12")&&d.iw.toggleClass("col-sm-12 col-sm-4"),d.iw.hasClass("info-window")?$(".animated").toggleClass(function(){return $(this).hasClass("fadeInUp")?"fadeOutDown":"fadeOutLeft"}).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){return d.setupHTML(d,b,c)}):d.iw.addClass("info-window").promise().done(function(){return d.setupHTML(d,b,c)})},setupHTML:function(a,b,c){var d=$(".app-content").empty(),e=$("<h3 />",{html:'<i class="emblem-seal emblem-seal-'+c.province+'"></i> '+c.title,"class":"district-title animated fadeInRight"}).prependTo(d),f=$("<div />",{"class":"district-area district-divider animated fadeInUp clearfix"}).insertAfter(e);$("<p />",{"class":"text-center district-area-figure",html:c.area.value.toLocaleString("en-GB")+" "+c.area.unit_short}).appendTo(f);{var g=$("<div />",{"class":"district-population district-divider animated fadeInUp",html:'<h4><i class="fa fa-male"></i> <i class="fa fa-female"></i> Population</h4> '}).insertAfter(f),h=$("<dl />",{"class":"dl-horizontal"}).appendTo(g);$("<dt />",{html:"1981"}).appendTo(h)}$("<dd />",{html:c.population.year[1981]?c.population.year[1981].toLocaleString("en-GB"):"N/A"}).appendTo(h);$("<dt />",{html:"1998"}).appendTo(h);$("<dd />",{html:c.population.year[1998]?c.population.year[1998].toLocaleString("en-GB"):"N/A"}).appendTo(h);var i=$("<div />",{"class":"district-gender-ratio district-divider animated fadeInUp",html:"<strong>Gender ratio:</strong>"}).insertAfter(h);$("<div />",{"class":"progress-bar",role:"progressbar","aria-valuenow":c.population.gender.male.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-male"></i> '+c.population.gender.male.percentage+"%"}).css("width",c.population.gender.male.percentage+"%").appendTo(i).wrap($("<div />",{"class":"progress progress-gender-ratio"})),$("<div />",{"class":"progress-bar progress-bar-success",role:"progressbar","aria-valuenow":c.population.gender.female.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-female"></i> '+c.population.gender.female.percentage+"%"}).css("width",c.population.gender.female.percentage+"%").appendTo(i).wrap($("<div />",{"class":"progress progress-gender-ratio"})),$("<p />",{html:'<i class="fa fa-info-circle"></i> '+c.population.ratio.value+" "+c.population.ratio.type}).appendTo(i),$("<p />",{html:'<i class="fa fa-info-circle"></i> '+c.population.density.value+" persons "+c.population.density.unit_short}).appendTo(i);var j=$("<div />",{"class":"district-urban-rural",html:'<h4><i class="fa fa-building"></i> Urban / Rural ratio</h4>'}).insertAfter(i);$("<div />",{"class":"progress-bar progress-bar-danger",role:"progressbar","aria-valuenow":c.population.urban.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-building"></i> Urban '+c.population.urban.percentage+"%"}).css("width",c.population.urban.percentage+"%").appendTo(j).wrap($("<div />",{"class":"progress progress-urban-rural"})),$("<div />",{"class":"progress-bar progress-bar-warning",role:"progressbar","aria-valuenow":c.population.rural.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-home"></i> Rural '+c.population.rural.percentage+"%"}).css("width",c.population.rural.percentage+"%").appendTo(j).wrap($("<div />",{"class":"progress progress-urban-rural"}));var k=$("<div />",{"class":"district-litracy-ratio district-divider animated fadeInUp",html:'<h4><i class="fa fa-graduation-cap"></i> Litracy ratio:</h4>'}).insertAfter(g);$("<div />",{"class":"progress-bar progress-bar-success",role:"progressbar","aria-valuenow":c.litracy_ratio.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:"Age "+c.litracy_ratio.age+" | "+c.litracy_ratio.percentage+"%"}).css("width",c.litracy_ratio.percentage+"%").appendTo(k).wrap($("<div />",{"class":"progress progress-litracy-ratio"}));var l=$("<div />",{"class":"district-household district-divider animated fadeInUp",html:'<h4><i class="fa fa-users"></i> Household average:</h4>'}).insertAfter(k);$("<p />",{"class":"district-household-average",html:c.household.size+" persons per house"}).appendTo(l);var m=$("<div />",{"class":"district-housing district-divider animated fadeInUp",html:'<h4><i class="fa fa-home"></i> Housing</h4>'}).insertAfter(l);if($("<p />",{html:"Total: "+c.housing.units.total.toLocaleString("en-GB")}).appendTo(m),c.housing.have_utilities.electricity&&$("<p />",{html:'<i class="fa fa-lightbulb-o"></i> Electricity: '+c.housing.have_utilities.electricity.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.electricity.percentage+"%"}).appendTo(m),c.housing.have_utilities.water&&$("<p />",{html:'<i class="fa fa-tint"></i> Water: '+c.housing.have_utilities.water.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.water.percentage+"%"}).appendTo(m),c.housing.have_utilities.gas&&$("<p />",{html:'<i class="fa fa-fire"></i> Gas: '+c.housing.have_utilities.gas.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.gas.percentage+"%"}).appendTo(m),c.boundary&&c.boundary.path){var n=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=n.namespaceURI;n.setAttribute("version","1.1"),n.setAttribute("id",c.boundary.meta.id),n.setAttribute("width",parseInt(c.boundary.meta.width)/1.25),n.setAttribute("height",parseInt(c.boundary.meta.height)/1.25),n.setAttribute("x",c.boundary.meta.x),n.setAttribute("y",c.boundary.meta.y),n.setAttribute("viewBox",c.boundary.meta.viewBox),n.setAttribute("enable-background","new "+c.boundary.meta.viewBox),n.setAttribute("xml:space","preserved");var p=document.createElementNS(o,"path");p.setAttribute("class","district-boundary"),p.setAttribute("fill","#ffffff"),p.setAttribute("stroke","#006838"),p.setAttribute("stroke-width","1.15"),p.setAttribute("d",c.boundary.path.join(" ")),n.appendChild(p),f[0].appendChild(n),$(n).wrap($("<div />",{"class":"district-svg text-center"}))}}},a}()),$(document).ready(function(){"use strict";var a=$("#mapCanvas");pkcensus.gmap.init(a[0],30.3894007,69.3532207,6,function(){pkcensus.gmap.setMarkers()})});