!function(a,b){window.pkcensus=window.pkcensus||b}(this,function(){"use strict";"undefined"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(a){for(var b=this,c=0;c<b.length;c++)if(b[c]===a)return c;return-1});var a={};return a.gmap={iw:$(".app-content"),markers:[],init:function(a,b,c,d,e){var f=this;this.canvas=a,this.defaultPosition=new google.maps.LatLng(parseFloat(b),parseFloat(c)),this.zoom="undefined"!=typeof d?parseInt(d):8,this.mapDefaults={center:this.defaultPosition,zoom:this.zoom,zoomControl:!1,streetViewControl:!1,panControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,mapTypeIds:["census_map",google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID]}},this.mapStyles=[{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"landscape.natural.terrain",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"simplified"}]}],this.censusMap=new google.maps.StyledMapType(this.mapStyles,{name:"Population Census"});var g=this.map=new google.maps.Map(this.canvas,this.mapDefaults);this.map.mapTypes.set("census_map",this.censusMap),this.map.setMapTypeId("census_map"),window.onresize=function(){google.maps.event.trigger(f.map,"resize"),f.map.getCenter()!==f.defaultPosition&&f.map.setCenter(f.defaultPosition)},google.maps.event.addListenerOnce(this.map,"tilesloaded",function(){return e&&"function"==typeof e?e.call(this,g):!1})},setMarkers:function(){var a=this;$.getJSON("./bower_components/pk-census/data/census-data.json",function(b,c){if(c&&"success"===c)for(var d=b.length-1;d>=0;d--){var e=b[d],f=new MarkerWithLabel({position:new google.maps.LatLng(e.location.lat,e.location.lng),map:a.map,icon:{path:google.maps.SymbolPath.CIRCLE,scale:3,strokeOpacity:.85,strokeColor:"#c30"},labelClass:"district-marker",labelContent:e.title,labelVisible:!1,labelAnchor:new google.maps.Point(-3,34)});a.markers.push(f),a.setMarkerInfo(a,f,e)}})},setMarkerInfo:function(a,b,c){var d=a;google.maps.event.addListener(b,"mouseover",function(){this.set("labelVisible",!0)}),google.maps.event.addListener(b,"mouseout",function(){this.set("labelVisible",!1)}),google.maps.event.addListener(b,"click",function(){return d.loadMarkerInfo(d,this,c)})},loadMarkerInfo:function(a,b,c){var d=a;d.iw.hasClass("info-window")?$(".animated").toggleClass(function(){return $(this).hasClass("fadeInUp")?"fadeOutDown":"fadeOutLeft"}).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){return d.setupHTML(d,b,c)}):d.iw.addClass("info-window").promise().done(function(){return d.setupHTML(d,b,c)})},closeIW:function(){var a=$(".info-window");a.length>0&&(a.empty(),a.removeClass("info-window"))},setupHTML:function(a,b,c){var d=a,e=$(".app-content").empty(),f=$("<h4 />",{html:'<i class="emblem-seal emblem-seal-'+c.province+'"></i> '+c.title,"class":"district-title animated fadeInRight"}).prependTo(e),g=$("<div />",{"class":"district-area district-divider animated fadeInUp clearfix"}).insertAfter(f);$("<p />",{"class":"text-center district-area-figure",html:c.area.value.toLocaleString("en-GB")+" "+c.area.unit_short}).appendTo(g);{var h=$("<div />",{"class":"district-population district-divider animated fadeInUp",html:'<h4><i class="fa fa-male"></i> <i class="fa fa-female"></i> Population</h4> '}).insertAfter(g),i=$("<dl />",{"class":"dl-horizontal"}).appendTo(h);$("<dt />",{html:"1981"}).appendTo(i)}$("<dd />",{html:c.population.year[1981]?c.population.year[1981].toLocaleString("en-GB"):"N/A"}).appendTo(i);$("<dt />",{html:"1998"}).appendTo(i);$("<dd />",{html:c.population.year[1998]?c.population.year[1998].toLocaleString("en-GB"):"N/A"}).appendTo(i);var j=$("<div />",{"class":"district-gender-ratio district-divider animated fadeInUp",html:"<strong>Gender ratio:</strong>"}).insertAfter(i);$("<div />",{"class":"progress-bar",role:"progressbar","aria-valuenow":c.population.gender.male.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-male"></i> '+c.population.gender.male.percentage+"%"}).css("width",c.population.gender.male.percentage+"%").appendTo(j).wrap($("<div />",{"class":"progress progress-gender-ratio"})),$("<div />",{"class":"progress-bar progress-bar-success",role:"progressbar","aria-valuenow":c.population.gender.female.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-female"></i> '+c.population.gender.female.percentage+"%"}).css("width",c.population.gender.female.percentage+"%").appendTo(j).wrap($("<div />",{"class":"progress progress-gender-ratio"})),$("<p />",{html:'<i class="fa fa-info-circle"></i> '+c.population.ratio.value+" "+c.population.ratio.type}).appendTo(j),$("<p />",{html:'<i class="fa fa-info-circle"></i> '+c.population.density.value+" persons "+c.population.density.unit_short}).appendTo(j);var k=$("<div />",{"class":"district-urban-rural",html:'<h4><i class="fa fa-building"></i> Urban / Rural ratio</h4>'}).insertAfter(j);$("<div />",{"class":"progress-bar progress-bar-danger",role:"progressbar","aria-valuenow":c.population.urban.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-building"></i> Urban '+c.population.urban.percentage+"%"}).css("width",c.population.urban.percentage+"%").appendTo(k).wrap($("<div />",{"class":"progress progress-urban-rural"})),$("<div />",{"class":"progress-bar progress-bar-warning",role:"progressbar","aria-valuenow":c.population.rural.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:'<i class="fa fa-home"></i> Rural '+c.population.rural.percentage+"%"}).css("width",c.population.rural.percentage+"%").appendTo(k).wrap($("<div />",{"class":"progress progress-urban-rural"}));var l=$("<div />",{"class":"district-litracy-ratio district-divider animated fadeInUp",html:'<h4><i class="fa fa-graduation-cap"></i> Litracy ratio:</h4>'}).insertAfter(h);$("<div />",{"class":"progress-bar progress-bar-success",role:"progressbar","aria-valuenow":c.litracy_ratio.percentage,"aria-valuemin":"0","aria-valuemax":"100",html:"Age "+c.litracy_ratio.age+" | "+c.litracy_ratio.percentage+"%"}).css("width",c.litracy_ratio.percentage+"%").appendTo(l).wrap($("<div />",{"class":"progress progress-litracy-ratio"}));var m=$("<div />",{"class":"district-household district-divider animated fadeInUp",html:'<h4><i class="fa fa-users"></i> Household average:</h4>'}).insertAfter(l);$("<p />",{"class":"district-household-average",html:c.household.size+" persons per house"}).appendTo(m);var n=$("<div />",{"class":"district-housing district-divider animated fadeInUp",html:'<h4><i class="fa fa-home"></i> Housing</h4>'}).insertAfter(m);if($("<p />",{html:"Total: "+c.housing.units.total.toLocaleString("en-GB")}).appendTo(n),c.housing.have_utilities.electricity&&$("<p />",{html:'<i class="fa fa-lightbulb-o"></i> Electricity: '+c.housing.have_utilities.electricity.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.electricity.percentage+"%"}).appendTo(n),c.housing.have_utilities.water&&$("<p />",{html:'<i class="fa fa-tint"></i> Water: '+c.housing.have_utilities.water.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.water.percentage+"%"}).appendTo(n),c.housing.have_utilities.gas&&$("<p />",{html:'<i class="fa fa-fire"></i> Gas: '+c.housing.have_utilities.gas.value.toLocaleString("en-GB")+" &ndash; "+c.housing.have_utilities.gas.percentage+"%"}).appendTo(n),c.boundary&&c.boundary.path){var o=document.createElementNS("http://www.w3.org/2000/svg","svg"),p=o.namespaceURI;o.setAttribute("version","1.1"),o.setAttribute("id",c.boundary.meta.id),o.setAttribute("width",parseInt(c.boundary.meta.width)/1.25),o.setAttribute("height",parseInt(c.boundary.meta.height)/1.25),o.setAttribute("x",c.boundary.meta.x),o.setAttribute("y",c.boundary.meta.y),o.setAttribute("viewBox",c.boundary.meta.viewBox),o.setAttribute("enable-background","new "+c.boundary.meta.viewBox),o.setAttribute("xml:space","preserved");var q=document.createElementNS(p,"path");q.setAttribute("class","district-boundary"),q.setAttribute("fill","#ffffff"),q.setAttribute("stroke","#006838"),q.setAttribute("stroke-width","1.15"),q.setAttribute("d",c.boundary.path.join(" ")),o.appendChild(q),g[0].appendChild(o),$(o).wrap($("<div />",{"class":"district-svg text-center"}))}$("<button />",{"class":"close clearfix",html:"&times;"}).prependTo(e).on("click",d.closeIW)}},a}()),$(document).ready(function(){"use strict";var a=$("#mapCanvas");pkcensus.gmap.init(a[0],30.3894007,69.3532207,6,function(){pkcensus.gmap.setMarkers()})});